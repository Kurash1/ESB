mission_trees:solitude += {
	cascabel_hall = {
		name = "Cascabel Hall"
		x = 6
		y = 3
		required = northwatch_keep
		inherit = not_implemented_mission
		trigger = {
			owns = cascabel_hall
			provinces:cascabel_hall = {
				fort_level = 2
			}
		}
		effect = {
			provinces:cascabel_hall = {
				change_trade_goods = fruits
				quick_province_modifier = {
					name = "Arbor of Golden Apples"
					modifier = {
						trade_value_modifier = 1.5 #this makes the base_price of the good 5 instead of 2
						trade_goods_size_modifier = 0.5
					}
				}
				quick_province_modifier = {
					name = "Impenetrable Cascabel Walls"
					modifier = {
						local_defensiveness = 0.5
						fort_level = 1
					}
				}
			}
			
			country_event = haafingar.1
		}
	}
}
new country_event haafingar.1 = {
	title = "Autonomy of Cascabel Hall"
	is_triggered_only = yes
	immediate = {
		areas:shadowgreen = {
			add_core = cascabel
		}
	}
	options = {
		{
			name = "Curtail their autonomy"
			effect = {
				areas:shadowgreen = {
					set_local_autonomy = 0
				}
			}
		}
		{
			name = "Autonomy for the Count of Cascabel"
			effect = {
				hidden_effect = {
					release = cascabel
				}
				create_subject = {
					subject_type = cascabel_subject
					subject = cascabel
				}
			}
		}
	}
}
new subject_type cascabel_subject = {
	name = "County"
	desc = ""
	title = "County"
	plural = "Counties"
	overlord = "County Overlord"
	subject = "County Subject"
	is_our = "§Y$NAME$§! is our County"

	copy_from = vassal
	
	sprite = GFX_icon_march
	diplomacy_overlord_sprite = GFX_diplomacy_leadmarch
	diplomacy_subject_sprite = GFX_diplomacy_weakmarch
	
	gives_daimyo_bonuses = yes
	counts_for_borders = yes
	takes_diplo_slot = yes
	scutage = no
	enforce_religion = yes
	siphon_income = yes
	seize_territory = no
	takeondebt = yes
	bestow_gifts = yes
	send_additional_troops = yes
	relative_power_class = 1
	max_government_rank = 2
	place_relative_on_throne = no
	joins_overlords_wars = no
	military_focus = 1.0
	clear_overlord_modifier = yes
	clear_subject_modifier = yes
	subject_modifiers = {
		{
			modifier = cascabel_nation
		}
		{
			modifier = cascabel_bonus
			trigger = {
				NOT = {
					development_of_overlord_fraction = 0.25
				}
			}
			expiration_message_overlord = MARCHTOOLARGE
			expiration_message_subject = MARCHTOOLARGEUS
		}
	}
	overlord_modifiers = {
		modifier = march_subject
	}
}
new localisation cascabel_nation = "Cascabel Nation"
new static_modifier cascabel_nation = {
	land_forcelimit = 10
	global_manpower = 15
}
new localisation cascabel_bonus = "Cascabel Bonus"
new static_modifier cascabel_bonus = {
	discipline = 0.1
}
new diplomatic_action call_cascabel = {
	name = "Call Cascabel to War"
	title = "Call Cascabel to War"
	desc = "Spend up to §R20§! Favors with §Y[From.GetName]§! and call them into ALL of §Y[Root.GetAdjective]§! wars. The cost is reduced by §Y10§! Favors if we can call §Y[From.GetName]§! only into defensive wars."
	tooltip = "Use our favors with the target country in order to call them into our wars."
	category = influence

	require_acceptance = no
	potential = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = cascabel_subject
		}
	}
	trigger = {
		if [
			FROM = { liberty_desire = 50 }
		] {
			custom_trigger_tooltip = {
				tooltip = FROM_IS_REBELLIOUS_TT
				FROM = { liberty_desire = 50 }
			}
		}
		if [
			is_at_war = no
		] {
			custom_trigger_tooltip = {
				tooltip = ROOT_IS_NOT_AT_WAR_TT
				is_at_war = yes
			}
		}
		if [
			FROM = {
				NOT = {
					owes_favors = {
						who = ROOT
						value = 10
					}
				}
			}
			is_in_war = {
				defender_leader = ROOT
			}
		] {
			custom_trigger_tooltip = {
				tooltip = FROM_MUST_OWE_10_FAVORS_DEFENSIVE_WAR_TT
				FROM = {
					owes_favors = {
						who = ROOT
						value = 10
					}
				}
			}
		}
		if [
			FROM = {
				NOT = {
					owes_favors = {
						who = ROOT
						value = 20
					}
				}
			}
			NOT = {
				is_in_war = {
					defender_leader = ROOT
				}
			}
		] {
			custom_trigger_tooltip = {
				tooltip = FROM_MUST_OWE_20_FAVORS_TT
				FROM = {
					owes_favors = {
						who = ROOT
						value = 20
					}
				}
			}
		}
		if [
			FROM = { is_at_war = yes }
		] {
			custom_trigger_tooltip = {
				tooltip = FROM_IS_AT_WAR_TT
				FROM = { is_at_war = no }
			}
		}
	}
	on_accept = {
		FROM = {
			ROOT = {
				add_favors = {
					who = PREV
					amount = -10
				}
			}
			join_all_defensive_wars_of = ROOT
		}
		if = {
			limit = {
				FROM = {
					owes_favors = {
						who = ROOT
						value = 10
					}
				}
			}
			FROM = {
				ROOT = {
					add_favors = {
						who = PREV
						amount = -10
					}
				}
				join_all_offensive_wars_of = ROOT
			}
		}
	}
	on_decline = {
	}

	ai_will_do = { # this is a trigger
		always = yes
	}
}