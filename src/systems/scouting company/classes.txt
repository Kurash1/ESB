new class survey = {
	list = surveys
	id = `{this:id}`
	args = {
		name = string
		x = int
		y = int
		province_group = province_group
	}
	on_create = {
		new custom_button `start_survey_{this:id}` = {
			tooltip = "Begin Surveying {this:name}"
			potential =* {
				has_country_flag = show_survey_screen
				NOT = {
					has_country_flag = surveyed_*this:id*
				}
				surveys:*this:id*:province_group = {
					NOT = { has_discovered = ROOT }
				}
			}
			trigger =* {
				has_global_modifier_value = {
					which = may_explore
					value = 1
				}
				NOT = {
					has_country_modifier = currently_surveying
				}
				surveys:*this:id*:province_group = {
					any_neighbor_province = {
						has_discovered = ROOT
					}
				}
			}
			effect =* {
				add_country_modifier = {
					name = currently_surveying
					duration = -1
				}
				set_country_flag = surveying_*this:id*
				&survey_progress := 0
				&survey_progress_percentage := 0
				
				surveys:*this:id*:province_group = {
					ROOT = {
						export_to_variable = {
							which = survey_temp
							value = trigger_value:province_size
							who = PREV
						}
						
						if [has_discovered = PREV] {
							&survey_temp := 0
						}
						
						&survey_length += survey_temp
					}
				}
			}
		}
		
		customizable_localizations:GetActiveSurvey:texts += {
			{
				text = this:name
				trigger =* {
					has_country_flag = `surveying_*this:id*`
				}
			}
		}
		
		interface_files:countrytechnologyview:countrytechnologyview += {
			guiButtonType = {
				name = `start_survey_{this:id}`
				position = { x = (this:x) y = (this:y-9) }
				quadTextureSprite = "GFX_survey_icon"
				scripted = yes
			}
		}
	}
}
new event_modifier currently_surveying = {
	name = "Currently Surveying"
	modifier = {
		scouts_casualty_reduction_modifier = -1
		scouts_maintenance_cost_modifier = 1
	}
}