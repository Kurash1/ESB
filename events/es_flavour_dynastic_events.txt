namespace = es_dynastic_events

# Event Manager

country_event = {
	id = es_dynastic_events.100
	title = es_dynastic_events.1.t
	desc = es_dynastic_events.1.d
	picture = ES_COFFIN_eventPicture
	
	hidden = yes
	is_triggered_only = yes

	immediate = {
		random_list = {
			1 = { country_event = { id = es_dynastic_events.1 } }
			1 = { country_event = { id = es_dynastic_events.2 } }
			1 = { country_event = { id = es_dynastic_events.3 } }
			1 = { country_event = { id = es_dynastic_events.4 } }
			1 = { country_event = { id = es_dynastic_events.5 } }
			1 = { country_event = { id = es_dynastic_events.6 } }
			1 = { country_event = { id = es_dynastic_events.7 } }
			1 = { country_event = { id = es_dynastic_events.8 } }
			1 = { country_event = { id = es_dynastic_events.11 } }
			1 = { country_event = { id = es_dynastic_events.12 } }
			1 = { country_event = { id = es_dynastic_events.13 } }
			1 = { country_event = { id = es_harem_events.3 } }
			88 = { set_country_flag = successful_dynastic_event }
		}
	}
	
	option = {
		name = es_dynastic_events.1.a
	}
	
	after = {
		if = {
			limit = { has_country_flag = successful_dynastic_event }
			clr_country_flag = successful_dynastic_event
		}
		else = {
			country_event = {
				id = es_dynastic_events.100
				days = 1
			}
		}
	}
}

# es_dynastic_events.1.t:0 "A beloved heir dies"
# es_dynastic_events.1.d:0 "A strange fever has claimed the life of your beloved heir, $HEIR$. As the court sheds its clothes for blacker garments, it strikes you what a frail and transient thing life can be. Just as your thoughts are about to turn to the eternal, a young maid catches your eye..."
# es_dynastic_events.1.a:0 "In the arms of the Gods, I find solace."
# es_dynastic_events.1.b:0 "In the arms of the maid, I find solace."
 
country_event = {
	id = es_dynastic_events.1
	title = es_dynastic_events.1.t
	desc = es_dynastic_events.1.d
	picture = ES_COFFIN_eventPicture
	
	trigger = {
		is_lesser_in_union = no
		NOT = { has_reform = mamluk_government }
		has_heir = yes
	}
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = { set_country_flag = successful_dynastic_event }
	}
	
	option = {
		name = es_dynastic_events.1.a
		kill_heir = {  }
		random_owned_province = {
			limit = {
				NOT = {
					has_building = temple
				}
				NOT = { has_building = cathedral }
				num_free_building_slots = 1
			}
			add_building = temple
		}
	}
	
	option = {
		name = es_dynastic_events.1.b
		trigger = {
			government = monarchy
		}
		kill_heir = {  }
		define_heir = {
			dynasty = ROOT
			claim = 30
		}
	}
}

# es_dynastic_events.2.t:0 "Palace Coup"
# es_dynastic_events.2.d:0 "'$MONARCH$,' $HEIR_S_PRONOUN$ says, $HEIR_ADJ$ sword pointing at you. 'Your rule has brought this nation to the brink of destruction, and shame to our family.' $HEIR_CAP_S_PRONOUN$ looks nervously at $HEIR_ADJ$ co-conspirators. An other-worldly sense of fatigue washes over you. Betrayal in your own midst?'"
# es_dynastic_events.2.a:0 "I feel so old..."
# es_dynastic_events.2.b:0 "You spoiled little runt!"
 
country_event = {
	id = es_dynastic_events.2
	title = es_dynastic_events.2.t
	desc = es_dynastic_events.2.d
	picture = ES_KING_AND_HEIR_eventPicture
	
	trigger = {
		is_lesser_in_union = no
		NOT = { has_reform = mamluk_government }
		has_heir = yes
	}
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = { set_country_flag = successful_dynastic_event }
	}
	
	option = {
		name = es_dynastic_events.2.a
		kill_ruler = yes
		add_country_modifier = {
			name = "illegitimate_ruler"
			duration = 3650
		}
	}
	
	option = {
		name = es_dynastic_events.2.b
		kill_heir = {  }
	}
}

# es_dynastic_events.3.t:0 "Heir falls ill"
# es_dynastic_events.3.d:0 "The heir, [Root.Heir.GetName], breathes heavily. $HEIR_CAP_S_PRONOUN$ has been lying in bed for three days now, and reflected in the beads of sweat on $HEIR_ADJ$ forehead is the fear in $HEIR_ADJ$ attendant's eyes for [Root.Heir.GetName]'s life. [Root.Heir.GetName] might not make it through the night unless something is done."
# es_dynastic_events.3.a:0 "Send for a trained Medicus."
# es_dynastic_events.3.b:0 "Pray for $HEIR_ADJ$ life."

country_event = {
	id = es_dynastic_events.3
	title = es_dynastic_events.3.t
	desc = es_dynastic_events.3.d
	picture = ES_MEDICINE_eventPicture
	
	trigger = {
		is_lesser_in_union = no
		NOT = { has_reform = mamluk_government }
		has_heir = yes
	}
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = { set_country_flag = successful_dynastic_event }
	}
	
	option = {
		name = es_dynastic_events.3.a
		add_years_of_income = -0.2
		random_list = {
			50 = { kill_heir = {  } }
			50 = {
				add_legitimacy = 10
				add_horde_unity = 10
				add_meritocracy = 10
				add_devotion = 10
			}
		}
	}
	
	option = {
		name = es_dynastic_events.3.b
		random_list = {
			75 = { kill_heir = {  } }
			25 = {
				add_legitimacy = 25
				add_horde_unity = 25
				add_meritocracy = 25
				add_devotion = 25
			}
		}
	}
}

# es_dynastic_events.4.t:0 "A Child in The Reeds"
# es_dynastic_events.4.d:0 "Suddenly something startles the animal and, before you have time to fire, it is long gone. You look around you. The water in the small creek reflects the sunlight of a perfect day, and the reeds wave slowly before a light breeze. Is that laughter? You realize now what had startled the animal. In a cradle, floating among the reeds, lies a laughing little boy. Judging by his smile, you'd say that he has never known fear in his life."
# es_dynastic_events.4.a:0 "Adopt him as your own"
# es_dynastic_events.4.b:0 "Where did that deer go?"

country_event = {
	id = es_dynastic_events.4
	title = es_dynastic_events.4.t
	desc = es_dynastic_events.4.d
	picture = ES_CHILD_IN_THE_REEDS_eventPicture
	
	trigger = {
		has_heir = no
		is_lesser_in_union = no
		government = monarchy
		has_regency = no
		NOT = { has_reform = mamluk_government }
		NOT = { has_reform = elective_monarchy }
		has_government_attribute = heir
	}
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = { set_country_flag = successful_dynastic_event }
	}
	
	option = {
		name = es_dynastic_events.4.a
		define_heir = {
			claim = 20
			dynasty = ROOT
			male = yes
			no_consort_with_heir = yes
		}
		add_prestige = -5
		add_country_modifier = {
			name = adopted_heir
			duration = 3650
		}
	}
	option = {
		name = es_dynastic_events.4.b
		add_years_of_income = 0.5
	}
}

# es_dynastic_events.5.t:0 "Hunting Accident"
# es_dynastic_events.5.d:0 "$HEIR_CAP_ADJ$ body has been draped, by whom you do not know, in a white cloth now stained red by $HEIR_ADJ$ lost vitae. They say $HEIR_S_PRONOUN$ was found by $HEIR_ADJ$ horse, in a clearing in the woods. You know the place they speak of. $HEIR_CAP_ADJ$ face is calm, almost serene. You reach out to touch $HEIR_O_PRONOUN$. The terrible reality of the situation dawns on you. The cold you feel is that of death."
# es_dynastic_events.5.a:0 "Sorrow overtakes you."
# es_dynastic_events.5.b:0 "Oh well..."
 
country_event = {
	id = es_dynastic_events.5
	title = es_dynastic_events.5.t
	desc = es_dynastic_events.5.d
	
	picture = {
		trigger = {
			has_female_heir = no
		}
		picture = ES_HUNTING_ACCIDENT_eventPicture
	}
	picture = {
		trigger = {
			has_female_heir = yes
		}
		picture = ES_HUNTING_ACCIDENT_female_eventPicture
	}
	
	trigger = {
		is_lesser_in_union = no
		NOT = { has_reform = mamluk_government }
		has_heir = yes
	}

	is_triggered_only = yes 
	
	immediate = {
		hidden_effect = { set_country_flag = successful_dynastic_event }
	}
	
	option = {
		name = es_dynastic_events.5.a
		kill_heir = {  }
		add_stability = -1
	}
	option = {
		name = es_dynastic_events.5.b
		kill_heir = {  }
		add_prestige = -15
	}
}

# es_dynastic_events.6.t:0 "Regent usurps The Throne"
# es_dynastic_events.6.d:0 "The $HEIR_DYNASTY$s have been nothing but bad news ever since they ascended to the throne. If you were to ask me, and I think you should, these good times are nothing but a sign, that my regency holds divine favor. With God on my side, I shall, therefore, assume the throne for myself. Good Night, Sweet Prince.'"
# es_dynastic_events.6.a:0 "It was destined."
# es_dynastic_events.6.b:0 "To the salt mines, traitor!"

country_event = {
	id = es_dynastic_events.6
	title = es_dynastic_events.6.t
	desc = es_dynastic_events.6.d
	picture = ES_REGENT_THRONE_eventPicture
	
	trigger = {
		is_lesser_in_union = no
		government = monarchy
		NOT = { has_reform = celestial_empire }
		NOT = { has_reform = mamluk_government }
		has_regency = yes
		has_consort_regency = no
		has_heir = yes
	}
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = { set_country_flag = successful_dynastic_event }
	}
	
	option = {
		name = es_dynastic_events.6.a
		kill_heir = {  }
		define_ruler = {
		}
		if = {
			limit = {
				has_states_general_mechanic = yes
			}
			change_statists_vs_orangists = 200
		}
		add_stability = -1
	}
	option = {
		name = es_dynastic_events.6.b
		add_stability = -3
		add_heir_claim = 100
		add_prestige = 50
	}
}

# es_dynastic_events.7.t:0 "Wedding Bells"
# es_dynastic_events.7.d:0 "Sire...', again the advisor interrupts you, their furrowed brow telling tall tales of concern and sleepless nights. '... the succession does not secure itself, your majesty...' On they go. This dusty old study, and your advisor's dry voice resonating of boredom and wasted potential, accentuates the brightness of the clear day outside. '...which is why it is of vital importance that...' - Don't they ever stop? 'In nature', you find yourself saying in interruption, 'the first step, leading an animal into the grave, is always procreation.' You're not sure if you believe it, only that there is nothing in their voice to convince you that marriage is preferable to the promise of a clear sky."
# es_dynastic_events.7.a:0 "Nevermind. Nature always finds its course."
# es_dynastic_events.7.b:0 "Chess on the veranda?"
 
country_event = {
	id = es_dynastic_events.7
	title = es_dynastic_events.7.t
	desc = es_dynastic_events.7.d
	picture = ES_WEDDING_eventPicture
	
	trigger = {
		government = monarchy
		is_lesser_in_union = no
		has_regency = no
		has_heir = no
		is_female = no
		has_government_attribute = queen
		has_government_attribute = heir
		any_known_country = {
			religion = ROOT
			government = monarchy
			is_lesser_in_union = no
			alliance_with = ROOT
		}
	}
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = { set_country_flag = successful_dynastic_event }
	}
	
	option = {
		name = es_dynastic_events.7.a
		random_country = {
			limit = {
				religion = ROOT
				government = monarchy
				is_lesser_in_union = no
				alliance_with = ROOT
				ai = yes
			}
			create_marriage = ROOT
		}
		
	}
	
	option = {
		name = es_dynastic_events.7.b
		add_prestige = 10
		add_country_modifier = {
			name = "sought_after_bachelor"
			duration = -1
		}
	}
}

# es_dynastic_events.8.t:0 "A Modest Proposal"
# es_dynastic_events.8.d:0 "While it is not uncommon among a certain type of young men to wish to remain outside the inevitable bonds of wedlock, the bonds are inevitable nevertheless. Looking out from your eagle's perch, you have spotted prey. The ruler of this foreign country has for a long time been postponing his marriage, and his throne lacks a secure succession. This might be the perfect time to form a dynastic bond between our countries. Should we dispatch an embassy to try to marry one of our dynasty's young girls into this foreign royal house?"
# es_dynastic_events.8.a:0 "Indeed we shall!"
# es_dynastic_events.8.b:0 "We have better things to do."

country_event = {
	id = es_dynastic_events.8
	title = es_dynastic_events.8.t
	desc = es_dynastic_events.8.d
	picture = ES_PRINCE_eventPicture
	
	trigger = {
		any_known_country = {
			has_country_modifier = sought_after_bachelor
			is_lesser_in_union = no
			government = monarchy
			religion_group = ROOT
		}
		government = monarchy
		is_lesser_in_union = no
	}
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = { set_country_flag = successful_dynastic_event }
	}
	
	option = {
		name = es_dynastic_events.8.a
		random_country = {
			limit = {
				has_country_modifier = sought_after_bachelor
				religion_group = ROOT
			}
			random_list = {
				20 = { country_event = { id = es_dynastic_events.9 } }
				80 = { country_event = { id = es_dynastic_events.10 } }
			}
		}
		add_treasury = -15
		add_dip_power = -10
	}
	
	option = {
		name = es_dynastic_events.8.b
		add_treasury = 10
		add_adm_power = 10
	}
}

# es_dynastic_events.9.t:0 "A rose from a foreign land"
# es_dynastic_events.9.d:0 "The ruler of $FROMCOUNTRY$ has sent you a painting, depicting a young girl in his court. Her eyes are green, her hair is black, and your eyes are drawn to the painting as if to a vacuum. A cunning smile find its way to your advisor's face. The noise of the room dies down. You do not know how long you stand there looking. She is beautiful."
# es_dynastic_events.9.a:0 "I must have her!"
# es_dynastic_events.9.b:0 "What is this foul witchcraft? Begone!"
 
country_event = {
	id = es_dynastic_events.9
	title = es_dynastic_events.9.t
	desc = es_dynastic_events.9.d
	picture = ES_PRINCESS_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = es_dynastic_events.9.a
		define_consort = {
			country_of_origin = FROM
			culture = FROM
			religion = FROM
		}
		create_marriage = FROM
		add_opinion = { who = FROM modifier = opinion_marriage_offer }
		remove_country_modifier = sought_after_bachelor
	}
	
	option = {
		name = es_dynastic_events.9.b
		reverse_add_opinion = { who = FROM modifier = opinion_witchcraft }
	}
}

# es_dynastic_events.10.t:0 "A thorn from a foreign land"
# es_dynastic_events.10.d:0 "While the poor quality of the painting might explain away some of it, the fact remains that the look of this girl is far from perfection. The ruler of $FROMCOUNTRY$ has offered her hand in marriage, and you are not sure if you should laugh or feel insulted. Then again, there is the succession to consider."
# es_dynastic_events.10.a:0 "A good $COUNTRY_RELIGION$ woman, I'm sure."
# es_dynastic_events.10.b:0 "This will obviously not do."
 
country_event = {
	id = es_dynastic_events.10
	title = "EVTNAME9487"
	desc = "EVTDESC9487"
	picture = ES_UGLY_PRINCESS_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = es_dynastic_events.10.a
		define_consort = {
			country_of_origin = FROM
			culture = FROM
			religion = FROM
		}
		create_marriage = FROM
		add_opinion = { who = FROM modifier = opinion_united_dynasties }
		remove_country_modifier = sought_after_bachelor
	}
	
	option = {
		name = es_dynastic_events.10.b
		reverse_add_opinion = { who = FROM modifier = opinion_refused_marriage }
	}
}

# es_dynastic_events.11.t:0 "Seeing The Real You"
# es_dynastic_events.11.d:0 "She turns around. She looks at you. - 'Have you prayed lately, $MONARCH$?' The question underscores the distance between you that, for the past year, has been growing. - 'I think you should. I do. Almost every night.' You laugh. For all her human flaws she is still your wife. She draws closer, the hint of a smile spreading across her face. - 'What are you laughing at, $MONARCH$'?"
# es_dynastic_events.11.a:0 "I just realized how much you mean to me."
# es_dynastic_events.11.b:0 "The economy is doing laughably good! Haha!"
 
country_event = {
	id = es_dynastic_events.11
	title = es_dynastic_events.11.t
	desc = es_dynastic_events.11.d
	picture = ES_PRINCESS_1_eventPicture
	
	trigger = {
		is_lesser_in_union = no
		government = monarchy
		NOT = { has_reform = mamluk_government }
		NOT = { has_reform = elective_monarchy }
		has_heir = no
		is_female = no
		has_regency = no
		num_of_royal_marriages = 1
		has_government_attribute = heir
		NOT = {
			has_country_modifier = a_woman_scorned
		}
	}
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = { set_country_flag = successful_dynastic_event }
	}
	
	option = {
		name = es_dynastic_events.11.a
		define_heir = {
			dynasty = ROOT
		}
	}
	
	option = {
		name = es_dynastic_events.11.b
		add_years_of_income = 1.5
		add_country_modifier = {
			name = "a_woman_scorned"
			duration = 3650
		}
	}
}

# es_dynastic_events.12.t:0 "Talented and Ambitious Daughter"
# es_dynastic_events.12.d:0 "The lack of an heir is worrying both the people of [Root.Country.GetName] and your advisors. You have an ambitious and talented daughter who has impressed both diplomats, foreign nobles and your personal advisors with her wit and cunning. Is it not time to consider her as the heir to the throne?"
# es_dynastic_events.12.a:0 "She would make an excellent ruler."
# es_dynastic_events.12.b:0 "I am not dead yet! I can still sire a son or two."

country_event = {
	id = es_dynastic_events.12
	title = es_dynastic_events.12.t
	desc = es_dynastic_events.12.d
	picture = ES_PRINCESS_BOOK_eventPicture
	
	trigger = {
		has_heir = no
		ruler_age = 50
		government = monarchy
		NOT = { has_reform = elective_monarchy }
		NOT = { has_reform = mamluk_government }
		has_government_attribute = heir
		is_lesser_in_union = no
		NOT = { has_ruler_flag = talented_daughter_happened }
	}
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			set_country_flag = successful_dynastic_event 
			set_ruler_flag = talented_daughter_happened
		}
	}
	
	option = {
		name = es_dynastic_events.12.a
		add_horde_unity = -15
		add_legitimacy = -15
		add_meritocracy = -15
		define_heir = {
			dynasty = ROOT
			age = 15
			claim = 50
			female = yes
			no_consort_with_heir = yes
		}
	}
	
	option = {
		name = es_dynastic_events.12.b
		random_owned_province = {
			limit = {
				is_capital = yes
			}
			add_province_modifier = {
				name = add_unrest_5_modifier
				duration = 3650
			}
		}
	}
}

# es_dynastic_events.13.t:0 "A Political Marriage"
# es_dynastic_events.13.d:0 "Few marriages in this time are based on romance, on passion or even friendship. Most are political, where the parents seek to join together two farms, two dynasties or two kingdoms. Without an heir and without a spouse, many have suggested that a marriage between our country and [nameless_neighbor_no_more.GetName] would be adequate, or even necessary."
# es_dynastic_events.13.a:0 "Send a herald to the monarch and suggest this political marriage between us."
# es_dynastic_events.13.b:0 "If I am to marry, it will be based on love."
 
country_event = {
	id = es_dynastic_events.13
	title = es_dynastic_events.13.t
	desc = es_dynastic_events.13.d
	picture = ES_WEDDING_RINGS_3_eventPicture
	
	trigger = {
		has_heir = no
		government = monarchy
		NOT = { has_reform = mamluk_government }
		NOT = { has_reform = elective_monarchy }
		is_free_or_tributary_trigger = yes
		any_neighbor_country = {
			government = monarchy
			NOT = { has_reform = elective_monarchy }
			has_heir = no
			NOT = {
				OR = {
					has_opinion_modifier = {
						who = ROOT
						modifier = opinion_spurned_pu
					}
					reverse_has_opinion_modifier = {
						who = ROOT
						modifier = opinion_spurned_pu
					}
				}
			}
			OR = {
				AND = {
					is_female = no
					ROOT = {
						is_female = yes
					}
				}
				AND = {
					is_female = yes
					ROOT = {
						is_female = no
					}
				}
			}
			OR = {
				dynasty = ROOT
				culture_group = ROOT
			}
			has_opinion = { who = ROOT value = 75 }
			reverse_has_opinion = { who = ROOT value = 75 }
			is_free_or_tributary_trigger = yes
		}
	}
	
	is_triggered_only = yes
	
	immediate = {
		random_neighbor_country = {
			limit = {
				government = monarchy
				NOT = { has_reform = elective_monarchy }
				has_heir = no
				NOT = {
					OR = {
						has_opinion_modifier = {
							who = ROOT
							modifier = opinion_spurned_pu
						}
						reverse_has_opinion_modifier = {
							who = ROOT
							modifier = opinion_spurned_pu
						}
					}
				}
				OR = {
					AND = {
						is_female = no
						ROOT = {
							is_female = yes
						}
					}
					AND = {
						is_female = yes
						ROOT = {
							is_female = no
						}
					}
				}
				OR = {
					dynasty = ROOT
					culture_group = ROOT
				}
				has_opinion = { who = ROOT value = 75 }
				reverse_has_opinion = { who = ROOT value = 75 }
				is_free_or_tributary_trigger = yes
			}
		}
		
		hidden_effect = { set_country_flag = successful_dynastic_event }
	}
	
	option = {
		name = es_dynastic_events.13.a
		random_neighbor_country = {
			limit = {
				government = monarchy
				NOT = { has_reform = elective_monarchy }
				has_heir = no
				NOT = {
					OR = {
						has_opinion_modifier = {
							who = ROOT
							modifier = opinion_spurned_pu
						}
						reverse_has_opinion_modifier = {
							who = ROOT
							modifier = opinion_spurned_pu
						}
					}
				}
				OR = {
					AND = {
						is_female = no
						ROOT = {
							is_female = yes
						}
					}
					AND = {
						is_female = yes
						ROOT = {
							is_female = no
						}
					}
				}
				OR = {
					dynasty = ROOT
					culture_group = ROOT
				}
				has_opinion = { who = ROOT value = 75 }
				reverse_has_opinion = { who = ROOT value = 75 }
				is_free_or_tributary_trigger = yes
			}
			country_event = {
				id = es_dynastic_events.14
				tooltip = es_dynastic_events.14.t
			}
		}
	}
	
	option = {
		name = es_dynastic_events.13.b
		add_legitimacy = 15
		add_meritocracy = 15
	}
}

# es_dynastic_events.14.t:0 "A Political Marriage Offered"
# es_dynastic_events.14.d:0 "A herald from [From.Country.GetName]'s [From.Monarch.GetTitle] [From.Monarch.GetName] has arrived, suggesting a marriage between them and [Root.Monarch.GetTitle] [Root.Monarch.GetName]."
# es_dynastic_events.14.a:0 "Accept it."
# es_dynastic_events.14.b:0 "Politely decline it."

country_event = {
	id = es_dynastic_events.14
	title = es_dynastic_events.14.t
	desc = es_dynastic_events.14.d
	picture = ES_WEDDING_RINGS_4_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = es_dynastic_events.14.a
		add_legitimacy = 25
		FROM = {
			set_ruler_flag = dyn_pu_accepted_flag
			create_union = ROOT
			country_event = {
				id = es_dynastic_events.15
				tooltip = es_dynastic_events.15.t
			}
		}
	}
	
	option = {
		name = es_dynastic_events.14.b
		FROM = {
			set_ruler_flag = dyn_pu_refused_flag
			add_opinion = {
				modifier = opinion_spurned_pu
				who = ROOT
			}
			add_casus_belli = {
				target = ROOT
				type = cb_insult
				months = 12
			}
			country_event = {
				id = es_dynastic_events.15
				tooltip = es_dynastic_events.15.t
			}
		}
	}
}

# es_dynastic_events.15.t:0 "A Political Marriage - Accepted or Not?"
# es_dynastic_events.15.d:0 "It was not with abated breath [Root.Monarch.GetTitle] [Root.Monarch.GetName] awaited the answer from [From.Country.GetName]'s [From.Monarch.GetTitle] [From.Monarch.GetName], but [Root.Monarch.GetHerHis] hands still trembled when the herald delivered the message."
# es_dynastic_events.15.a:0 "[From.Monarch.GetTitle] [From.Monarch.GetName] accepted!"
# es_dynastic_events.15.b:0 "[From.Monarch.GetTitle] [From.Monarch.GetName] refused!"
 
country_event = {
	id = es_dynastic_events.15
	title = es_dynastic_events.15.t
	desc = es_dynastic_events.15.d
	picture = ES_WEDDING_RINGS_5_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = es_dynastic_events.15.a
		trigger = {
			has_ruler_flag = dyn_pu_accepted_flag
		}
		add_legitimacy = 25
		tooltip = {
			create_union = FROM
		}
	}
	
	option = {
		name = es_dynastic_events.15.b
		trigger = {
			has_ruler_flag = dyn_pu_refused_flag
		}
		tooltip = {
			add_opinion = {
				modifier = opinion_spurned_pu
				who = FROM
			}
			add_casus_belli = {
				target = FROM
				type = cb_insult
				months = 12
			}
		}
	}
}

namespace = es_harem_events

# es_harem_events.1.t:0 "The Sons of [Root.Monarch.GetName]"
# es_harem_events.1.d:0 "His Majesty [Root.Monarch.GetName] [Root.Monarch.GetTitle] has a reputation as a great man and is unchallenged as a ruler. As befits a man of his caliber and stature [Root.Monarch.GetName] has fathered several capable children and many who show great promise as future rulers. Both the sons themselves and our government officials are acutely aware that only one can inherit and what awaits the others. Our Governors are adamant that it is now high time for [Root.Monarch.GetName] to name a favorite among the possible successors. This is unlikely to end the competition for [Root.Monarch.GetHerHis] favor but it will hopefully stop the worst succession struggles that might follow if our [Root.Monarch.GetTitle] should die without having picked a clear successor."
# es_harem_events.1.d.female:0 "Her Majesty [Root.Monarch.GetName] [Root.Monarch.GetTitle] has a reputation as a great woman and is unchallenged as a ruler. As befits a ruler of her caliber and stature [Root.Monarch.GetName] has mothered several capable children and many who show great promise as future rulers. Both the sons themselves and our government officials are acutely aware that only one can inherit and what awaits the others. Our Governors are adamant that it is now high time for [Root.Monarch.GetName] to name a favorite among the possible successors. This is unlikely to end the competition for [Root.Monarch.GetHerHis] favor but it will hopefully stop the worst succession struggles that might follow if our [Root.Monarch.GetTitle] should die without having picked a clear successor."
# es_harem_events.1.a:0 "The Pious son is our favorite."
# es_harem_events.1.b:0 "The Strongest son is our favorite."
# es_harem_events.1.c:0 "The Studious son is our favorite."
# es_harem_events.1.e:0 "The Gregarious son is our favorite."
# es_harem_events.1.f:0 "The Natural Leader is our favorite."
# es_harem_events.1.g:0 "The Fairest son is our favorite."
# es_harem_events.1.h:0 "The Entrepreneurial son is our favorite."
# es_harem_events.1.i:0 "The Inquisitive son is our favorite."
# es_harem_events.1.j:0 "The Most Gifted son is our favorite."
# es_harem_events.1.k:0 "The Generous son is our favorite."
 
country_event = {
	id = es_harem_events.1
	title = es_harem_events.1.t
	picture = ES_CHILDREN_eventPicture
	
	is_triggered_only = yes
	
	desc = {
		trigger = {
			is_female = yes
		}
		desc = es_harem_events.1.d.female
	}
	desc = {
		trigger = {
			is_female = no
		}
		desc = es_harem_events.1.d
	}

	immediate = {
		hidden_effect = {
			random_list = {
				33 = {
					set_country_flag = harem_fairest_heir
				}
				33 = {
					set_country_flag = harem_strong_heir
				}
				33 = {
					set_country_flag = harem_leadership_heir
				}
				1 = {
					set_country_flag = harem_genious_heir
				}
			}
			random_list = {
				33 = {
					set_country_flag = harem_studious_heir
				}
				33 = {
					set_country_flag = harem_pious_heir
				}
				33 = {
					set_country_flag = harem_inquisitive_heir
				}
			}
			random_list = {
				33 = {
					set_country_flag = harem_gregarious_heir
				}
				33 = {
					set_country_flag = harem_entrepreneurial_heir
				}
				33 = {
					set_country_flag = harem_generous_heir
				}
			}
		}
	}

	option = {
		name = es_harem_events.1.a
		trigger = {
			ai = no
			has_country_flag = harem_pious_heir
		}
		clr_country_flag = harem_pious_heir
		clr_country_flag = harem_strong_heir
		clr_country_flag = harem_leadership_heir
		clr_country_flag = harem_genious_heir
		clr_country_flag = harem_studious_heir
		clr_country_flag = harem_inquisitive_heir
		clr_country_flag = harem_gregarious_heir
		clr_country_flag = harem_entrepreneurial_heir
		clr_country_flag = harem_generous_heir
		clr_country_flag = harem_fairest_heir
		define_heir = {
			dynasty = original_dynasty
			male = yes
			max_random_adm = 7
			max_random_dip = 5
			max_random_mil = 5
			age = 10
		}
	}
	option = {	 
		name = es_harem_events.1.b
		trigger = {
			ai = no
			has_country_flag = harem_strong_heir
		}
		clr_country_flag = harem_pious_heir
		clr_country_flag = harem_strong_heir
		clr_country_flag = harem_leadership_heir
		clr_country_flag = harem_genious_heir
		clr_country_flag = harem_studious_heir
		clr_country_flag = harem_inquisitive_heir
		clr_country_flag = harem_gregarious_heir
		clr_country_flag = harem_entrepreneurial_heir
		clr_country_flag = harem_generous_heir
		clr_country_flag = harem_fairest_heir
		define_heir = {
			dynasty = original_dynasty
			male = yes
			max_random_adm = 5
			max_random_dip = 5
			max_random_mil = 7
			age = 10
		}
	}
	option = {	 
		name = es_harem_events.1.c
		trigger = {
			ai = no
			has_country_flag = harem_studious_heir
		}
		clr_country_flag = harem_pious_heir
		clr_country_flag = harem_strong_heir
		clr_country_flag = harem_leadership_heir
		clr_country_flag = harem_genious_heir
		clr_country_flag = harem_studious_heir
		clr_country_flag = harem_inquisitive_heir
		clr_country_flag = harem_gregarious_heir
		clr_country_flag = harem_entrepreneurial_heir
		clr_country_flag = harem_generous_heir
		clr_country_flag = harem_fairest_heir
		define_heir = {
			dynasty = original_dynasty
			male = yes
			max_random_adm = 7
			max_random_dip = 5
			max_random_mil = 5
			age = 10
		}
	}
	option = {	 
		name = es_harem_events.1.e
		trigger = {
			ai = no
			has_country_flag = harem_leadership_heir
		}
		clr_country_flag = harem_pious_heir
		clr_country_flag = harem_strong_heir
		clr_country_flag = harem_leadership_heir
		clr_country_flag = harem_genious_heir
		clr_country_flag = harem_studious_heir
		clr_country_flag = harem_inquisitive_heir
		clr_country_flag = harem_gregarious_heir
		clr_country_flag = harem_entrepreneurial_heir
		clr_country_flag = harem_generous_heir
		clr_country_flag = harem_fairest_heir
		define_heir = {
			dynasty = original_dynasty
			male = yes
			max_random_adm = 5
			max_random_dip = 5
			max_random_mil = 7
			age = 10
		}
	}
	option = {	 
		name = es_harem_events.1.f
		trigger = {
			ai = no
			has_country_flag = harem_gregarious_heir
		}
		clr_country_flag = harem_pious_heir
		clr_country_flag = harem_strong_heir
		clr_country_flag = harem_leadership_heir
		clr_country_flag = harem_genious_heir
		clr_country_flag = harem_studious_heir
		clr_country_flag = harem_inquisitive_heir
		clr_country_flag = harem_gregarious_heir
		clr_country_flag = harem_entrepreneurial_heir
		clr_country_flag = harem_generous_heir
		clr_country_flag = harem_fairest_heir
		define_heir = {
			dynasty = original_dynasty
			male = yes
			max_random_adm = 5
			max_random_dip = 7
			max_random_mil = 5
			age = 10
		}
	}
	option = {	 
		name = es_harem_events.1.g
		trigger = {
			ai = no
			has_country_flag = harem_fairest_heir
		}
		clr_country_flag = harem_pious_heir
		clr_country_flag = harem_strong_heir
		clr_country_flag = harem_leadership_heir
		clr_country_flag = harem_genious_heir
		clr_country_flag = harem_studious_heir
		clr_country_flag = harem_inquisitive_heir
		clr_country_flag = harem_gregarious_heir
		clr_country_flag = harem_entrepreneurial_heir
		clr_country_flag = harem_generous_heir
		clr_country_flag = harem_fairest_heir
		define_heir = {
			dynasty = original_dynasty
			male = yes
			age = 10
			max_random_adm = 7
			max_random_dip = 7
			max_random_mil = 7
		}
	}
	option = {	 
		name = es_harem_events.1.h
		trigger = {
			ai = no
			has_country_flag = harem_entrepreneurial_heir
		}
		clr_country_flag = harem_pious_heir
		clr_country_flag = harem_strong_heir
		clr_country_flag = harem_leadership_heir
		clr_country_flag = harem_genious_heir
		clr_country_flag = harem_studious_heir
		clr_country_flag = harem_inquisitive_heir
		clr_country_flag = harem_gregarious_heir
		clr_country_flag = harem_entrepreneurial_heir
		clr_country_flag = harem_generous_heir
		clr_country_flag = harem_fairest_heir
		define_heir = {
			dynasty = original_dynasty
			male = yes
			max_random_adm = 5
			max_random_dip = 7
			max_random_mil = 5
			age = 10
		}
	}
	option = {	 
		name = es_harem_events.1.i
		trigger = { has_country_flag = harem_inquisitive_heir }
		clr_country_flag = harem_pious_heir
		clr_country_flag = harem_strong_heir
		clr_country_flag = harem_leadership_heir
		clr_country_flag = harem_genious_heir
		clr_country_flag = harem_studious_heir
		clr_country_flag = harem_inquisitive_heir
		clr_country_flag = harem_gregarious_heir
		clr_country_flag = harem_entrepreneurial_heir
		clr_country_flag = harem_generous_heir
		clr_country_flag = harem_fairest_heir
		define_heir = {
			dynasty = original_dynasty
			male = yes
			age = 10
			max_random_adm = 7
			max_random_dip = 7
			max_random_mil = 7
		}
	}
	option = {	 
		name = es_harem_events.1.j
		trigger = {
			ai = no
			has_country_flag = harem_genious_heir
		}
		clr_country_flag = harem_pious_heir
		clr_country_flag = harem_strong_heir
		clr_country_flag = harem_leadership_heir
		clr_country_flag = harem_genious_heir
		clr_country_flag = harem_studious_heir
		clr_country_flag = harem_inquisitive_heir
		clr_country_flag = harem_gregarious_heir
		clr_country_flag = harem_entrepreneurial_heir
		clr_country_flag = harem_generous_heir
		clr_country_flag = harem_fairest_heir
		define_heir = {
			dynasty = original_dynasty
			male = yes
			DIP = 0
			MIL = 0
			ADM = 0
			age = 10
			max_random_adm = 7
			max_random_dip = 7
			max_random_mil = 7
		}
	}
	option = {	 
		name = es_harem_events.1.k
		trigger = {
			ai = no
			has_country_flag = harem_generous_heir
		}
		clr_country_flag = harem_pious_heir
		clr_country_flag = harem_strong_heir
		clr_country_flag = harem_leadership_heir
		clr_country_flag = harem_genious_heir
		clr_country_flag = harem_studious_heir
		clr_country_flag = harem_inquisitive_heir
		clr_country_flag = harem_gregarious_heir
		clr_country_flag = harem_entrepreneurial_heir
		clr_country_flag = harem_generous_heir
		clr_country_flag = harem_fairest_heir
		define_heir = {
			dynasty = original_dynasty
			male = yes
			age = 10
			max_random_adm = 7
			max_random_dip = 7
			max_random_mil = 7
		}
	}
	option = {
		trigger = { ai = yes }
		name = es_harem_events.1.k
		clr_country_flag = harem_pious_heir
		clr_country_flag = harem_strong_heir
		clr_country_flag = harem_leadership_heir
		clr_country_flag = harem_genious_heir
		clr_country_flag = harem_studious_heir
		clr_country_flag = harem_inquisitive_heir
		clr_country_flag = harem_gregarious_heir
		clr_country_flag = harem_entrepreneurial_heir
		clr_country_flag = harem_generous_heir
		clr_country_flag = harem_fairest_heir
		define_heir = {
			dynasty = original_dynasty
			male = yes
			age = 10
			max_random_adm = 7
			max_random_dip = 7
			max_random_mil = 7
		}
	}
}

# es_harem_events.2.t:0 "Sword of [Root.Country.GetName]"
# es_harem_events.2.d:0 "The coronation ceremony is the most grand thing many will see in their lifetime. As the Sword of [Root.Country.GetName] is girded upon [Root.Monarch.GetName] our Governors look upon [Root.Monarch.GetHerHim] with some amount of dread. [Root.Monarch.GetSheHeCap] was never the most likely of candidates and would likely never have taken the throne if a clear favorite had existed. Some would go as far as to say that it was [Root.Monarch.GetHerHis] mediocrity that allowed [Root.Monarch.GetName] to triumph. Greater men never considered [Root.Monarch.GetHerHim] a threat and others hoped to control the state through [Root.Monarch.GetHerHim]. One thing our new [Root.Monarch.GetTitle] has clearly demonstrated: When the need arises [Root.Monarch.GetSheHe] will not shy away from sinking a dagger in the back of those that trust [Root.Monarch.GetHerHim]."
# es_harem_events.2.a:0 "Long live the [Root.Monarch.GetTitle]!"

country_event = {
	id = es_harem_events.2
	title = es_harem_events.2.t
	desc = es_harem_events.2.d
	picture = ES_CORONATION_SWORD_eventPicture
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			define_ruler = {
				dynasty = original_dynasty
				male = yes
				age = 25
				max_random_adm = 3
				max_random_mil = 3
				max_random_dip = 3
			}
		}
	}

	option = {
		name = es_harem_events.2.a
	}
}

# es_harem_events.3.t:0 "Treachery within the Family"
# es_harem_events.3.d:0 "Word has reached us that the beloved and most favored of sons, [Root.Heir.GetName], is plotting against [Root.Heir.GetHerHis] father and aims to overthrow the state. Our trusted and closest consort implores us to cut off this cancer from our body and have [Root.Heir.GetName] murdered. There can be no doubt that the consort speaks out of her own interest in this matter, [Root.Heir.GetName] is no son of hers but his replacement is very likely to be. Our own ministers also speak of [Root.Heir.GetName]'s betrayal, however, and he could pose a very real threat."
# es_harem_events.3.a:0 "[Root.Heir.GetName] must die..."
# es_harem_events.3.a.tt:0 "Send assassins to kill §Y[Root.Heir.GetName]§!.\nIf they fail this will provoke a revolt regardless of his guilt."
# es_harem_events.3.b:0 "Summon [Root.Heir.GetName] to defend himself."
# es_harem_events.3.b.tt:0 "If the rumors are true this will give §Y[Root.Heir.GetName]§! time to assemble a bigger army."
# es_harem_events.3.c:0 "I will not listen to such lies!"
# es_harem_events.3.c.tt:0 "§Y[Root.Consort.GetName]§! falls from grace.\nIf the rumors are true this will give §Y[Root.Heir.GetName]§! time to assemble a bigger army."
 
country_event = {
	id = es_harem_events.3
	title = es_harem_events.3.t
	desc = es_harem_events.3.d
	picture = ES_KING_1_eventPicture

	is_triggered_only = yes

	trigger = {
		has_reform = ottoman_government
		has_heir = yes
		has_female_heir = no
		heir_age = 15
		has_regency = no
		is_female = no
		has_consort = yes
	}

	immediate = {
		hidden_effect = {
			random_list = {
				50 = {
					set_ruler_flag = heir_plotting
				}
				50 = {
					set_ruler_flag = heir_framed_for_plot
				}
			}
			set_country_flag = successful_dynastic_event
		}
	}

	option = {
		name = es_harem_events.3.a
		custom_tooltip = es_harem_events.3.a.tt
		hidden_effect = {
			random_list = {
				75 = { country_event = { id = es_harem_events.7 } }
				25 = { country_event = { id = es_harem_events.6 } }
			}
			if = {
				limit = { has_ruler_flag = heir_plotting }
				clr_ruler_flag = heir_plotting
			}
			if = {
				limit = { has_ruler_flag = heir_framed_for_plot }
				clr_ruler_flag = heir_framed_for_plot
			}
		}
	}
	option = {
		name = es_harem_events.3.b
		custom_tooltip = es_harem_events.3.b.tt
		hidden_effect = {
			trigger_switch = {
				on_trigger = has_ruler_flag
				heir_plotting = {
					country_event = { id = es_harem_events.5 days = 7 }
					clr_ruler_flag = heir_plotting
				}
				heir_framed_for_plot = {
					country_event = { id = es_harem_events.4 days = 7 }
					clr_ruler_flag = heir_framed_for_plot
				}
			}
		}
	}
	option = {
		name = es_harem_events.3.c
		custom_tooltip = es_harem_events.3.c.tt
		remove_consort = yes
		hidden_effect = {
		define_consort = { age = 25 }
		trigger_switch = {
			on_trigger = has_ruler_flag
			heir_plotting = {
				country_event = { id = es_harem_events.5 days = 7 }
				clr_ruler_flag = heir_plotting
			}
			heir_framed_for_plot = {
				country_event = { id = es_harem_events.4 days = 7 }
				clr_ruler_flag = heir_framed_for_plot
			}
		}
	}
}

	after = {
		clr_ruler_flag = heir_plotting
		clr_ruler_flag = heir_framed_for_plot
	}
}

# es_harem_events.4.t:0 "[Root.Heir.GetName] is Innocent"
# es_harem_events.4.d:0 "Given time to present his case [Root.Heir.GetName] has fully convinced our [Root.Monarch.GetTitle] of his innocence and will remain the most favored of our heirs. This entire ordeal has strengthened his standing at court and with the public in [Root.Capital.GetCapitalName]."
# es_harem_events.4.a:0 "I'm not one to be fooled so easily."

country_event = {
	id = es_harem_events.4
	title = es_harem_events.4.t
	desc = es_harem_events.4.d
	picture = ES_KING_AND_COURT_eventPicture
	
	is_triggered_only = yes

	option = {
		name = es_harem_events.4.a
		add_prestige = 10
		if = {
			limit = {
				NOT = { heir_claim = 100 }
			}
			add_heir_claim =  10
		}
	}
}

# es_harem_events.5.t:0 "The Plot of [Root.Heir.GetName]"
# es_harem_events.5.d:0 "The time afforded by our indecisiveness was sufficient for [Root.Heir.GetName] to be able to assemble the rebel army he had intended. As the sun sets on the seventh day after his discovery an army is marching towards [Root.Capital.GetCapitalName]."
# es_harem_events.5.a:0 "Yes son?"

country_event = {
	id = es_harem_events.5
	title = es_harem_events.5.t
	desc = es_harem_events.5.d
	picture = ES_KING_AND_HEIR_eventPicture
	
	is_triggered_only = yes

	option = {
		name = es_harem_events.5.a
		
		random_owned_province = {
			limit = {
				is_capital = yes
			}
			spawn_rebels = {
				type = pretender_rebels
				culture = ROOT
				religion = ROOT
				size = 3.5
				use_heir_as_leader = yes
			}
			random_neighbor_province = {
				limit = {
					owned_by = ROOT
					is_capital = no
					is_in_capital_area = yes
				}
				spawn_rebels = {
					type = pretender_rebels
					size = 2.5
					culture = ROOT
					religion = ROOT
				}
			}
			random_neighbor_province = {
				limit = {
					owned_by = ROOT
					is_capital = no
					is_in_capital_area = yes
				}
				spawn_rebels = {
					type = pretender_rebels
					size = 1.5
					culture = ROOT
					religion = ROOT
				}
			}
		}
		define_heir = {
			male = yes
			age = 15
			dynasty = original_dynasty
		}
	}
}

# es_harem_events.6.t:0 "The Fate of a [Root.Heir.GetName]"
# es_harem_events.6.d:0 "The assassins we sent to kill [Root.Heir.GetName] have returned after successfully completing their mission. We shall never know if he was guilty of treason or not."
# es_harem_events.6.a:0 "A great tragedy."
 
country_event = {
	id = es_harem_events.6
	title = es_harem_events.6.t
	desc = es_harem_events.6.d
	picture = ES_MURDER_eventPicture
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = { kill_heir = {  } }
	}
	
	option = {
		name = es_harem_events.6.a
		add_prestige = -10
	}
}

# es_harem_events.7.t:0 "The Fate of a [Root.Heir.GetName]"
# es_harem_events.7.d:0 "The assassins we sent to kill [Root.Heir.GetName] failed to perform their mission. Our former heir has fled the capital together with a group of his closest supporters and now prepares to fight for their lives."
# es_harem_events.7.a:0 "Disaster!"

country_event = {
	id = es_harem_events.7
	title = es_harem_events.7.t
	desc = es_harem_events.7.d
	picture = FAILED_MURDER_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = es_harem_events.7.a
		random_owned_province = {
			spawn_rebels = {
				type = pretender_rebels 
				culture = ROOT
				religion = ROOT
				size = 2.5
				use_heir_as_leader = yes
			}
		}
		hidden_effect = {
			define_heir = {
				dynasty = original_dynasty
				male = yes
				age = 15
			}
		}
	}
}