<html>
<?vsp
	declare val_serviceId, val_sid, val_realm, val_uname varchar;
	declare val_isRealUser integer;
	declare val_cert any;
	
	val_realm := null;

	VAL.DBA.get_authentication_details_for_connection (
		sid=>val_sid,
		serviceId=>val_serviceId,
		uname=>val_uname,
		isRealUser=>val_isRealUser,
		realm=>val_realm,
		cert=>val_cert);

	http_value(concat('val_sid       : ',val_sid       ), 'p');
	http_value(concat('val_serviceId : ',val_serviceId ), 'p');
	http_value(concat('val_uname     : ',val_uname     ), 'p');
	http_value(concat('val_isRealUser: ',val_isRealUser), 'p');
	http_value(concat('val_realm     : ',val_realm     ), 'p');
	http_value(concat('val_cert      : ',val_cert      ), 'p');

	declare _id int;
	declare _confirm any;
	
	declare response any;
	declare output varchar;
	declare query varchar;
	declare graph varchar;
	declare max_results integer;
	
	max_results := 20;   
	graph := concat(val_serviceId,'-main');
	
	query := concat('
SELECT * { 
	?app <http://www.ekseli.fi/Invite> ?id
}');

	http_value(query, 'pre style="background-color: black; color: white; border: red; border-style: solid; width: fit-content; padding: 15px; font-family: monospace;"');

	response := DB.DBA.SPARQL_EVAL_TO_ARRAY(query, graph, max_results);
	
	for (declare i int, i := 0; i < length (response); i := i+1) {
		output := '';
		for (declare j int, j:= 0; j < length (response[i]); j := j+1) {
			output := concat(output, ' ', response[i][j]);
		}
		http_value(output, 'p');
	}
?>
</html>